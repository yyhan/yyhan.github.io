

<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
    <meta name="description" content="JUST DO IT">
    <title>
        hessian 2.0 序列化协议 | YFHan的博客
    </title>
    <link rel="shortcut icon" href="/favicon.jpg"/>
    

    
    
    
    <!-- stylesheets list from config.yml -->
        
            <link rel="stylesheet" href="/css/aloha.css">
        
            <link rel="stylesheet" href="//cdn.bootcss.com/semantic-ui/2.2.4/semantic.min.css">
        
            <link rel="stylesheet" href="//cdn.bootcss.com/magnific-popup.js/1.1.0/magnific-popup.min.css">
        
    

</head>

<body id="body" style="margin-bottom: 0;" class="pushable">

    <div class="ui top fixed menu">
        <a class="item" id="menu-icon"><i class="sidebar icon"></i></a>
    </div>

    <div id="menu-sidebar" class="ui left vertical sidebar menu">

    <div id="sidebar-top">
        <div class="content">
            <h3>YFHan的博客</h3>
        </div>
    </div>
    <div class="ui container sidebar-card">
    <div class="ui people shape content">
        <div class="active side">
            <div class="ui card">
                <div class="image">
                    <img class="ui medium bordered image" src="/favicon_400x400.jpg">
                </div>
                <div class="content">
                    <a class="header">
                        YFHan
                    </a>
                    
                        <div class="meta">
                            Programer / Dotaor
                        </div>
                        
                </div>
                <div class="extra content">
                    <div class="ui list">
                        
                            <div class="item">
                                <i class="marker icon" style="float: left"></i>
                                <div class="content">
                                    杭州
                                </div>
                            </div>
                            
                                
                    </div>

                </div>
                <div class="extra content">
                    <div class="ui list">
                        

                            <a href="https://github.com/yyhan"><i class="large github icon" style="float: left"></i></a>

                            
                    </div>
                </div>
            </div>
        </div>
    </div>


</div>

    
    

    

    
    <a href="/index.html" class="item" >
        <i class="home icon"></i>
        首页
    </a>

    
    

    

    
    <a href="/archives/" class="item" >
        <i class="archive icon"></i>
        归档
    </a>

    
    

    

    
    <a href="/atom.xml" class="item" >
        <i class="rss icon"></i>
        RSS
    </a>

    
    

    

    
    <a href="/about" class="item" >
        <i class="mail icon"></i>
        关于
    </a>

    

    
</div>

        <div class="pusher body-content">
            <div id="content" class="ui main container">
                <div id="post-hessian-2-0-序列化协议" class="ui main container article-type-post">

    

    <div class="ui divided grid">

        <div class="two column row" id="article-content">

            <div class="thirteen wide computer thirteen wide tablet sixteen wide mobile column">
                

<h1 class="ui header">
    
    hessian 2.0 序列化协议
</h1>



                <div class="article-inner">

                    <div class="article-entry" itemprop="articleBody">
                        
                        <p>Hessian 2.0 &#x5E8F;&#x5217;&#x5316;&#x534F;&#x8BAE;&#x7FFB;&#x8BD1;&#xFF0C;&#x539F;&#x6587;&#x94FE;&#x63A5;<a href="http://hessian.caucho.com/doc/hessian-ws.html" target="_blank" rel="external">http://hessian.caucho.com/doc/hessian-ws.html</a></p>
<h1 id="&#x4ECB;&#x7ECD;"><a href="#&#x4ECB;&#x7ECD;" class="headerlink" title="&#x4ECB;&#x7ECD;"></a>&#x4ECB;&#x7ECD;</h1><p>Hessian&#x662F;&#x4E00;&#x79CD;&#x52A8;&#x6001;&#x7C7B;&#x578B;&#x7684;&#x3001;&#x91C7;&#x7528;&#x4E8C;&#x8FDB;&#x5236;&#x5E8F;&#x5217;&#x5316;&#x7684;&#xFF0C;&#x5E76;&#x4E14;&#x88AB;&#x8BBE;&#x8BA1;&#x4E3A;&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x4F20;&#x8F93;&#x7684;Web&#x670D;&#x52A1;&#x534F;&#x8BAE;&#x3002;</p>
<h1 id="&#x8BBE;&#x8BA1;&#x76EE;&#x6807;"><a href="#&#x8BBE;&#x8BA1;&#x76EE;&#x6807;" class="headerlink" title="&#x8BBE;&#x8BA1;&#x76EE;&#x6807;"></a>&#x8BBE;&#x8BA1;&#x76EE;&#x6807;</h1><p>Hessian&#x662F;&#x52A8;&#x6001;&#x7C7B;&#x578B;&#x7684;&#xFF0C;&#x7D27;&#x51D1;&#x7684;&#xFF0C;&#x53EF;&#x8DE8;&#x8BED;&#x8A00;&#x79FB;&#x690D;&#x7684;&#x3002;</p>
<p>Hessian&#x534F;&#x8BAE;&#x6709;&#x4EE5;&#x4E0B;&#x51E0;&#x4E2A;&#x8BBE;&#x8BA1;&#x76EE;&#x6807;:</p>
<ul class="ui list">
<li>It must self-describe the serialized types, i.e. not require external schema or interface definitions.</li>
<li>It must be language-independent, including supporting scripting languages.</li>
<li>It must be readable or writable in a single pass.</li>
<li>It must be as compact as possible.</li>
<li>It must be simple so it can be effectively tested and implemented.</li>
<li>It must be as fast as possible.</li>
<li>It must support Unicode strings.</li>
<li>It must support 8-bit binary data without escaping or using attachments.</li>
<li>It must support encryption, compression, signature, and transaction context envelopes.</li>
</ul>
<h1 id="Hessian-&#x8BED;&#x6CD5;"><a href="#Hessian-&#x8BED;&#x6CD5;" class="headerlink" title="Hessian &#x8BED;&#x6CD5;"></a>Hessian &#x8BED;&#x6CD5;</h1><h2 id="&#x5E8F;&#x5217;&#x5316;&#x8BED;&#x6CD5;"><a href="#&#x5E8F;&#x5217;&#x5316;&#x8BED;&#x6CD5;" class="headerlink" title="&#x5E8F;&#x5217;&#x5316;&#x8BED;&#x6CD5;"></a>&#x5E8F;&#x5217;&#x5316;&#x8BED;&#x6CD5;</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div></pre></td><td class="code"><pre><div class="line">           # starting production</div><div class="line">top        ::= value</div><div class="line"></div><div class="line">           # 8-bit binary data split into 64k chunks</div><div class="line">binary     ::= x41 b1 b0 &lt;binary-data&gt; binary # non-final chunk</div><div class="line">           ::= &apos;B&apos; b1 b0 &lt;binary-data&gt;        # final chunk</div><div class="line">           ::= [x20-x2f] &lt;binary-data&gt;        # binary data of</div><div class="line">                                                 #  length 0-15</div><div class="line">           ::= [x34-x37] &lt;binary-data&gt;        # binary data of</div><div class="line">                                                 #  length 0-1023</div><div class="line"></div><div class="line">           # boolean true/false</div><div class="line">boolean    ::= &apos;T&apos;</div><div class="line">           ::= &apos;F&apos;</div><div class="line"></div><div class="line">           # definition for an object (compact map)</div><div class="line">class-def  ::= &apos;C&apos; string int string*</div><div class="line"></div><div class="line">           # time in UTC encoded as 64-bit long milliseconds since</div><div class="line">           #  epoch</div><div class="line">date       ::= x4a b7 b6 b5 b4 b3 b2 b1 b0</div><div class="line">           ::= x4b b3 b2 b1 b0       # minutes since epoch</div><div class="line"></div><div class="line">           # 64-bit IEEE double</div><div class="line">double     ::= &apos;D&apos; b7 b6 b5 b4 b3 b2 b1 b0</div><div class="line">           ::= x5b                   # 0.0</div><div class="line">           ::= x5c                   # 1.0</div><div class="line">           ::= x5d b0                # byte cast to double</div><div class="line">                                     #  (-128.0 to 127.0)</div><div class="line">           ::= x5e b1 b0             # short cast to double</div><div class="line">           ::= x5f b3 b2 b1 b0       # 32-bit float cast to double</div><div class="line"></div><div class="line">           # 32-bit signed integer</div><div class="line">int        ::= &apos;I&apos; b3 b2 b1 b0</div><div class="line">           ::= [x80-xbf]             # -x10 to x3f</div><div class="line">           ::= [xc0-xcf] b0          # -x800 to x7ff</div><div class="line">           ::= [xd0-xd7] b1 b0       # -x40000 to x3ffff</div><div class="line"></div><div class="line">           # list/vector</div><div class="line">list       ::= x55 type value* &apos;Z&apos;   # variable-length list</div><div class="line">	   ::= &apos;V&apos; type int value*   # fixed-length list</div><div class="line">           ::= x57 value* &apos;Z&apos;        # variable-length untyped list</div><div class="line">           ::= x58 int value*        # fixed-length untyped list</div><div class="line">	   ::= [x70-77] type value*  # fixed-length typed list</div><div class="line">	   ::= [x78-7f] value*       # fixed-length untyped list</div><div class="line"></div><div class="line">           # 64-bit signed long integer</div><div class="line">long       ::= &apos;L&apos; b7 b6 b5 b4 b3 b2 b1 b0</div><div class="line">           ::= [xd8-xef]             # -x08 to x0f</div><div class="line">           ::= [xf0-xff] b0          # -x800 to x7ff</div><div class="line">           ::= [x38-x3f] b1 b0       # -x40000 to x3ffff</div><div class="line">           ::= x59 b3 b2 b1 b0       # 32-bit integer cast to long</div><div class="line"></div><div class="line">           # map/object</div><div class="line">map        ::= &apos;M&apos; type (value value)* &apos;Z&apos;  # key, value map pairs</div><div class="line">	   ::= &apos;H&apos; (value value)* &apos;Z&apos;       # untyped key, value</div><div class="line"></div><div class="line">           # null value</div><div class="line">null       ::= &apos;N&apos;</div><div class="line"></div><div class="line">           # Object instance</div><div class="line">object     ::= &apos;O&apos; int value*</div><div class="line">	   ::= [x60-x6f] value*</div><div class="line"></div><div class="line">           # value reference (e.g. circular trees and graphs)</div><div class="line">ref        ::= x51 int            # reference to nth map/list/object</div><div class="line"></div><div class="line">           # UTF-8 encoded character string split into 64k chunks</div><div class="line">string     ::= x52 b1 b0 &lt;utf8-data&gt; string  # non-final chunk</div><div class="line">           ::= &apos;S&apos; b1 b0 &lt;utf8-data&gt;         # string of length</div><div class="line">                                             #  0-65535</div><div class="line">           ::= [x00-x1f] &lt;utf8-data&gt;         # string of length</div><div class="line">                                             #  0-31</div><div class="line">           ::= [x30-x34] &lt;utf8-data&gt;         # string of length</div><div class="line">                                             #  0-1023</div><div class="line"></div><div class="line">           # map/list types for OO languages</div><div class="line">type       ::= string                        # type name</div><div class="line">           ::= int                           # type reference</div><div class="line"></div><div class="line">           # main production</div><div class="line">value      ::= null</div><div class="line">           ::= binary</div><div class="line">           ::= boolean</div><div class="line">           ::= class-def value</div><div class="line">           ::= date</div><div class="line">           ::= double</div><div class="line">           ::= int</div><div class="line">           ::= list</div><div class="line">           ::= long</div><div class="line">           ::= map</div><div class="line">           ::= object</div><div class="line">           ::= ref</div><div class="line">           ::= string</div></pre></td></tr></table></figure>
<h1 id="&#x5E8F;&#x5217;&#x5316;"><a href="#&#x5E8F;&#x5217;&#x5316;" class="headerlink" title="&#x5E8F;&#x5217;&#x5316;"></a>&#x5E8F;&#x5217;&#x5316;</h1><p>Hessian&#x7684;&#x5BF9;&#x8C61;&#x5E8F;&#x5217;&#x5316;&#x6709;8&#x4E2A;&#x539F;&#x59CB;&#x7C7B;&#x578B;:</p>
<ul class="ui list">
<li>raw binary data</li>
<li>boolean</li>
<li>64-bit millisecond date</li>
<li>64-bit double</li>
<li>32-bit int</li>
<li>64-bit long</li>
<li>null</li>
<li>UTF8-encoded string</li>
</ul>
<p>&#x5B83;&#x6709;3&#x4E2A;&#x9012;&#x5F52;&#x7C7B;&#x578B;:</p>
<ul class="ui list">
<li>list for lists and arrays</li>
<li>map for maps and dictionaries</li>
<li>object for objects</li>
</ul>
<p>&#x6700;&#x540E;&#xFF0C;&#x5B83;&#x6709;&#x4E00;&#x4E2A;&#x7279;&#x6B8A;&#x7684;&#x6784;&#x9020;:</p>
<ul class="ui list">
<li>ref for shared and circular object references.</li>
</ul>
<p>Hessian 2.0 &#x6709;&#x4E09;&#x4E2A;&#x5185;&#x7F6E;&#x5F15;&#x7528;&#x7C7B;&#x578B;&#x6620;&#x5C04;:</p>
<ul class="ui list">
<li>An object/list reference map.</li>
<li>An class definition reference map.</li>
<li>A type (class name) reference map.</li>
</ul>
<h2 id="&#x4E8C;&#x8FDB;&#x5236;&#x6570;&#x636E;"><a href="#&#x4E8C;&#x8FDB;&#x5236;&#x6570;&#x636E;" class="headerlink" title="&#x4E8C;&#x8FDB;&#x5236;&#x6570;&#x636E;"></a>&#x4E8C;&#x8FDB;&#x5236;&#x6570;&#x636E;</h2><p>&#x4E8C;&#x8FDB;&#x5236;&#x6570;&#x636E;&#x8BED;&#x6CD5;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">binary ::= b b1 b0 &lt;binary-data&gt; binary</div><div class="line">       ::= B b1 b0 &lt;binary-data&gt;</div><div class="line">       ::= [x20-x2f] &lt;binary-data&gt;</div></pre></td></tr></table></figure></p>
<p>&#x4E8C;&#x8FDB;&#x5236;&#x6570;&#x636E;&#x4F7F;&#x7528;&#x5757;&#x7F16;&#x7801;&#x3002;&#x516B;&#x8FDB;&#x5236; <code>0x42(&apos;B&apos;)</code>&#x7F16;&#x7801;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5757;&#xFF0C;<code>0x62(&apos;b&apos;)</code>&#x8868;&#x793A;&#x9664;&#x4E86;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5757;&#x4EE5;&#x5916;&#x7684;&#x5757;&#x3002;&#x6BCF;&#x4E2A;&#x5757;&#x90FD;&#x6709;&#x4E00;&#x4E2A;16&#x4F4D;&#x7684;&#x957F;&#x5EA6;&#x503C;&#x3002;&#x957F;&#x5EA6;&#x503C;&#x516C;&#x5F0F;&#xFF1A;</p>
<p>len = 256 * b1 + b0</p>
<h3 id="&#x538B;&#x7F29;&#x77ED;&#x4E8C;&#x8FDB;&#x5236;"><a href="#&#x538B;&#x7F29;&#x77ED;&#x4E8C;&#x8FDB;&#x5236;" class="headerlink" title="&#x538B;&#x7F29;&#x77ED;&#x4E8C;&#x8FDB;&#x5236;"></a>&#x538B;&#x7F29;&#x77ED;&#x4E8C;&#x8FDB;&#x5236;</h3><p>&#x957F;&#x5EA6;&#x5C0F;&#x4E8E;15&#x7684;&#x4E8C;&#x8FDB;&#x5236;&#x6570;&#x636E;&#x91C7;&#x7528;&#x4E00;&#x4E2A;&#x516B;&#x8FDB;&#x5236;&#x6570;&#x636E;&#x8868;&#x793A;&#x957F;&#x5EA6;&#xFF0C;&#x8BE5;&#x516B;&#x8FDB;&#x5236;&#x6570;&#x636E;&#x53D6;&#x503C;&#x8303;&#x56F4;&#xFF1A;[x20-x2f]&#xFF0C;&#x957F;&#x5EA6;&#x503C;&#x516C;&#x5F0F;&#xFF1A;</p>
<p>len = code - 0x20</p>
<h3 id="&#x4E8C;&#x8FDB;&#x5236;&#x793A;&#x4F8B;"><a href="#&#x4E8C;&#x8FDB;&#x5236;&#x793A;&#x4F8B;" class="headerlink" title="&#x4E8C;&#x8FDB;&#x5236;&#x793A;&#x4F8B;"></a>&#x4E8C;&#x8FDB;&#x5236;&#x793A;&#x4F8B;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">x20               # 0&#x957F;&#x5EA6;&#x4E8C;&#x8FDB;&#x5236;&#x6570;&#x636E;</div><div class="line"></div><div class="line">x23 x01 x02 x03   # 3&#x4E2A;&#x516B;&#x5B57;&#x8282;&#x6570;&#x636E;</div><div class="line"></div><div class="line">B x10 x00 ....    # 4k &#x7ED3;&#x5C3E;&#x6570;&#x636E;&#x5757;</div><div class="line"></div><div class="line">b x04 x00 ....    # 1k &#x975E;&#x7ED3;&#x5C3E;&#x6570;&#x636E;&#x5757;</div></pre></td></tr></table></figure>
<h2 id="boolean"><a href="#boolean" class="headerlink" title="boolean"></a>boolean</h2><p>Boolean&#x8BED;&#x6CD5;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">boolean ::= T</div><div class="line">        ::= F</div></pre></td></tr></table></figure></p>
<p>&#x5B57;&#x8282; <code>&apos;F&apos;</code> &#x8868;&#x793A;<code>false</code>&#xFF0C;&#x5B57;&#x8282; <code>&apos;T&apos;</code> &#x8868;&#x793A;<code>true</code></p>
<h3 id="Boolean-&#x793A;&#x4F8B;"><a href="#Boolean-&#x793A;&#x4F8B;" class="headerlink" title="Boolean &#x793A;&#x4F8B;"></a>Boolean &#x793A;&#x4F8B;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">T   # true</div><div class="line">F   # false</div></pre></td></tr></table></figure>
<h2 id="date"><a href="#date" class="headerlink" title="date"></a>date</h2><p>Date &#x8BED;&#x6CD5;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">date ::= x4a b7 b6 b5 b4 b3 b2 b1 b0</div><div class="line">     ::= x4b b4 b3 b2 b1 b0</div></pre></td></tr></table></figure></p>
<p>&#x65E5;&#x671F;&#x7C7B;&#x578B;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;64&#x4F4D;&#x7684;<code>long</code>&#x6570;&#x503C;&#x8868;&#x793A;&#x4ECE;<code>1970-01-01 00:00:00</code>&#x4EE5;&#x6765;&#x7ECF;&#x8FC7;&#x7684;&#x6BEB;&#x79D2;&#x6570;&#x3002;</p>
<h3 id="&#x538B;&#x7F29;&#xFF1A;&#x4F7F;&#x7528;&#x5206;&#x949F;&#x8868;&#x793A;&#x65E5;&#x671F;"><a href="#&#x538B;&#x7F29;&#xFF1A;&#x4F7F;&#x7528;&#x5206;&#x949F;&#x8868;&#x793A;&#x65E5;&#x671F;" class="headerlink" title="&#x538B;&#x7F29;&#xFF1A;&#x4F7F;&#x7528;&#x5206;&#x949F;&#x8868;&#x793A;&#x65E5;&#x671F;"></a>&#x538B;&#x7F29;&#xFF1A;&#x4F7F;&#x7528;&#x5206;&#x949F;&#x8868;&#x793A;&#x65E5;&#x671F;</h3><p>&#x7B2C;&#x4E8C;&#x79CD;&#x65B9;&#x5F0F;&#x662F;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;32&#x4F4D;&#x7684;<code>int</code>&#x6570;&#x503C;&#x8868;&#x793A;&#x4ECE;<code>1970-01-01 00:00</code>&#x4EE5;&#x6765;&#x7ECF;&#x8FC7;&#x7684;&#x5206;&#x949F;&#x6570;&#x3002;</p>
<h3 id="&#x65E5;&#x671F;-&#x793A;&#x4F8B;"><a href="#&#x65E5;&#x671F;-&#x793A;&#x4F8B;" class="headerlink" title="&#x65E5;&#x671F; &#x793A;&#x4F8B;"></a>&#x65E5;&#x671F; &#x793A;&#x4F8B;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">x4a x00 x00 x00 xd0 x4b x92 x84 xb8   # 09:51:31 1998&#x5E74;5&#x6708;8&#x65E5;UTC</div><div class="line"></div><div class="line">x4b x4b x92 x0b xa0                   # 09:51:00 1998&#x5E74;5&#x6708;8&#x65E5;UTC</div></pre></td></tr></table></figure>
<h2 id="double"><a href="#double" class="headerlink" title="double"></a>double</h2><p>Double &#x8BED;&#x6CD5;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">double ::= D b7 b6 b5 b4 b3 b2 b1 b0</div><div class="line">       ::= x5b</div><div class="line">       ::= x5c</div><div class="line">       ::= x5d b0</div><div class="line">       ::= x5e b1 b0</div><div class="line">       ::= x5f b3 b2 b1 b0</div></pre></td></tr></table></figure></p>
<p>&#x4E00;&#x4E2A;64&#x4F4D;&#x7684;IEEE&#x6807;&#x51C6;&#x7684;&#x6D6E;&#x70B9;&#x6570;&#x3002;</p>
<h3 id="&#x538B;&#x7F29;&#xFF1A;double-zero"><a href="#&#x538B;&#x7F29;&#xFF1A;double-zero" class="headerlink" title="&#x538B;&#x7F29;&#xFF1A;double zero"></a>&#x538B;&#x7F29;&#xFF1A;double zero</h3><p>double&#x7C7B;&#x578B;&#x7684;<code>0.0</code>&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5B57;&#x8282;<code>x5b</code>&#x8868;&#x793A;&#x3002;</p>
<h3 id="&#x538B;&#x7F29;&#xFF1A;double-one"><a href="#&#x538B;&#x7F29;&#xFF1A;double-one" class="headerlink" title="&#x538B;&#x7F29;&#xFF1A;double one"></a>&#x538B;&#x7F29;&#xFF1A;double one</h3><p>double&#x7C7B;&#x578B;&#x7684;<code>1.0</code>&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5B57;&#x8282;<code>x5c</code>&#x8868;&#x793A;&#x3002;</p>
<h3 id="&#x538B;&#x7F29;-double-octet"><a href="#&#x538B;&#x7F29;-double-octet" class="headerlink" title="&#x538B;&#x7F29;: double octet"></a>&#x538B;&#x7F29;: double octet</h3><p>&#x4ECB;&#x4E8E;<code>-128.0</code> &#x548C; <code>127.0</code> &#x4E4B;&#x95F4;&#xFF0C;&#x4E14;&#x6CA1;&#x6709;&#x5C0F;&#x6570;&#x90E8;&#x5206;&#x7684;double&#x6570;&#x503C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E24;&#x4E2A;&#x5B57;&#x8282;&#x8868;&#x793A;&#x3002;&#x8F6C;&#x6362;&#x516C;&#x5F0F;&#xFF1A;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">value = (double) b0</div></pre></td></tr></table></figure></p>
<h3 id="&#x538B;&#x7F29;-double-short"><a href="#&#x538B;&#x7F29;-double-short" class="headerlink" title="&#x538B;&#x7F29;: double short"></a>&#x538B;&#x7F29;: double short</h3><p>&#x4ECB;&#x4E8E;<code>-32768.0</code> &#x548C; <code>32767.0</code> &#x4E4B;&#x95F4;&#xFF0C;&#x4E14;&#x6CA1;&#x6709;&#x5C0F;&#x6570;&#x90E8;&#x5206;&#x7684;double&#x6570;&#x503C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E09;&#x4E2A;&#x5B57;&#x8282;&#x8868;&#x793A;&#x3002;&#x8F6C;&#x6362;&#x516C;&#x5F0F;&#xFF1A;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">value = (double) (256 * b1 + b0)</div></pre></td></tr></table></figure></p>
<h3 id="&#x538B;&#x7F29;-double-float"><a href="#&#x538B;&#x7F29;-double-float" class="headerlink" title="&#x538B;&#x7F29;: double float"></a>&#x538B;&#x7F29;: double float</h3><p>Doubles which are equivalent to their 32-bit float representation can be represented as the 4-octet float and then cast to double.</p>
<h3 id="Double-&#x793A;&#x4F8B;"><a href="#Double-&#x793A;&#x4F8B;" class="headerlink" title="Double &#x793A;&#x4F8B;"></a>Double &#x793A;&#x4F8B;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">x5b          # 0.0</div><div class="line">x5c          # 1.0</div><div class="line"></div><div class="line">x5d x00      # 0.0</div><div class="line">x5d x80      # -128.0</div><div class="line">x5d x7f      # 127.0</div><div class="line"></div><div class="line">x5e x00 x00  # 0.0</div><div class="line">x5e x80 x00  # -32768.0</div><div class="line">x5e x7f xff  # 32767.0</div><div class="line"></div><div class="line">D x40 x28 x80 x00 x00 x00 x00 x00  # 12.25</div></pre></td></tr></table></figure>
<h2 id="int"><a href="#int" class="headerlink" title="int"></a>int</h2><p>Integer &#x8BED;&#x6CD5;&#xFF1A;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">int ::= &apos;I&apos; b3 b2 b1 b0</div><div class="line">    ::= [x80-xbf]</div><div class="line">    ::= [xc0-xcf] b0</div><div class="line">    ::= [xd0-xd7] b1 b0</div></pre></td></tr></table></figure></p>
<p>A 32-bit signed integer. An integer is represented by the octet x49 (&#x2018;I&#x2019;) followed by the 4 octets of the integer in big-endian order.</p>
<p>value = (b3 &lt;&lt; 24) + (b2 &lt;&lt; 16) + (b1 &lt;&lt; 8) + b0;</p>
<h3 id="&#x538B;&#x7F29;&#xFF1A;&#x5355;&#x5B57;&#x8282;&#x6574;&#x6570;"><a href="#&#x538B;&#x7F29;&#xFF1A;&#x5355;&#x5B57;&#x8282;&#x6574;&#x6570;" class="headerlink" title="&#x538B;&#x7F29;&#xFF1A;&#x5355;&#x5B57;&#x8282;&#x6574;&#x6570;"></a>&#x538B;&#x7F29;&#xFF1A;&#x5355;&#x5B57;&#x8282;&#x6574;&#x6570;</h3><p>&#x4ECB;&#x4E8E;<code>-16</code> &#x548C; <code>47</code> &#x4E4B;&#x95F4;&#x7684;&#x6574;&#x6570;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5355;&#x4E2A;&#x4F4D;&#x4E8E;<code>[x80, xbf]</code>&#x8303;&#x56F4;&#x5185;&#x7684;&#x5B57;&#x8282;&#x8868;&#x793A;&#x3002;&#x8F6C;&#x6362;&#x516C;&#x5F0F;&#xFF1A;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">value = code - 0x90</div></pre></td></tr></table></figure></p>
<h3 id="&#x538B;&#x7F29;&#xFF1A;&#x53CC;&#x5B57;&#x8282;&#x6574;&#x6570;"><a href="#&#x538B;&#x7F29;&#xFF1A;&#x53CC;&#x5B57;&#x8282;&#x6574;&#x6570;" class="headerlink" title="&#x538B;&#x7F29;&#xFF1A;&#x53CC;&#x5B57;&#x8282;&#x6574;&#x6570;"></a>&#x538B;&#x7F29;&#xFF1A;&#x53CC;&#x5B57;&#x8282;&#x6574;&#x6570;</h3><p>&#x4ECB;&#x4E8E;<code>-2048</code> &#x548C; <code>2047</code> &#x4E4B;&#x95F4;&#x7684;&#x6574;&#x6570;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E24;&#x4E2A;&#x5B57;&#x8282;&#x8868;&#x793A;&#xFF0C;&#x9996;&#x5B57;&#x8282;&#x4F4D;&#x4E8E;<code>[xc0, xcf]</code>&#x8303;&#x56F4;&#x5185;&#x3002;&#x8F6C;&#x6362;&#x516C;&#x5F0F;&#xFF1A;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">value = ((code - 0xc8) &lt;&lt; 8) + b0;</div></pre></td></tr></table></figure></p>
<h3 id="&#x538B;&#x7F29;&#xFF1A;&#x4E09;&#x5B57;&#x8282;&#x6574;&#x6570;"><a href="#&#x538B;&#x7F29;&#xFF1A;&#x4E09;&#x5B57;&#x8282;&#x6574;&#x6570;" class="headerlink" title="&#x538B;&#x7F29;&#xFF1A;&#x4E09;&#x5B57;&#x8282;&#x6574;&#x6570;"></a>&#x538B;&#x7F29;&#xFF1A;&#x4E09;&#x5B57;&#x8282;&#x6574;&#x6570;</h3><p>&#x4ECB;&#x4E8E;<code>-262144</code> &#x548C; <code>262143</code> &#x4E4B;&#x95F4;&#x7684;&#x6574;&#x6570;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E09;&#x4E2A;&#x5B57;&#x8282;&#x8868;&#x793A;&#xFF0C;&#x9996;&#x5B57;&#x8282;&#x4F4D;&#x4E8E;<code>[xd0, xd7]</code>&#x8303;&#x56F4;&#x5185;&#x3002;&#x8F6C;&#x6362;&#x516C;&#x5F0F;&#xFF1A;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">value = ((code - 0xd4) &lt;&lt; 16) + (b1 &lt;&lt; 8) + b0;</div></pre></td></tr></table></figure></p>
<h3 id="Integer-&#x793A;&#x4F8B;"><a href="#Integer-&#x793A;&#x4F8B;" class="headerlink" title="Integer &#x793A;&#x4F8B;"></a>Integer &#x793A;&#x4F8B;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">x90                # 0</div><div class="line">x80                # -16</div><div class="line">xbf                # 47</div><div class="line"></div><div class="line">xc8 x00            # 0</div><div class="line">xc0 x00            # -2048</div><div class="line">xc7 x00            # -256</div><div class="line">xcf xff            # 2047</div><div class="line"></div><div class="line">xd4 x00 x00        # 0</div><div class="line">xd0 x00 x00        # -262144</div><div class="line">xd7 xff xff        # 262143</div><div class="line"></div><div class="line">I x00 x00 x00 x00  # 0</div><div class="line">I x00 x00 x01 x2c  # 300</div></pre></td></tr></table></figure>
<h2 id="list"><a href="#list" class="headerlink" title="list"></a>list</h2><p>List &#x8BED;&#x6CD5;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">list ::= x55 type value* &apos;Z&apos;   # variable-length list</div><div class="line">     ::= &apos;V&apos; type int value*   # fixed-length list</div><div class="line">     ::= x57 value* &apos;Z&apos;        # variable-length untyped list</div><div class="line">     ::= x58 int value*        # fixed-length untyped list</div><div class="line">     ::= [x70-77] type value*  # fixed-length typed list</div><div class="line">     ::= [x78-7f] value*       # fixed-length untyped list</div></pre></td></tr></table></figure>
<p>An ordered list, like an array. The two list productions are a fixed-length list and a variable length list. Both lists have a type. The type string may be an arbitrary UTF-8 string understood by the service.</p>
<p>Each list item is added to the reference list to handle shared and circular elements. See the ref element.</p>
<p>Any parser expecting a list must also accept a null or a shared ref.</p>
<p>The valid values of type are not specified in this document and may depend on the specific application. For example, a server implemented in a language with static typing which exposes an Hessian interface can use the type information to instantiate the specific array type. On the other hand, a server written in a dynamicly-typed language would likely ignore the contents of type entirely and create a generic array.</p>
<h3 id="Compact-fixed-length-list"><a href="#Compact-fixed-length-list" class="headerlink" title="Compact: fixed length list"></a>Compact: fixed length list</h3><p>Hessian 2.0 allows a compact form of the list for successive lists of the same type where the length is known beforehand. The type and length are encoded by integers, where the type is a reference to an earlier specified type.</p>
<h3 id="List-&#x793A;&#x4F8B;"><a href="#List-&#x793A;&#x4F8B;" class="headerlink" title="List &#x793A;&#x4F8B;"></a>List &#x793A;&#x4F8B;</h3><p>&#x5E8F;&#x5217;&#x5316;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#x6570;&#x7EC4;: int[] = {0, 1}<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">V                    # fixed length, typed list</div><div class="line">  x04 [int           # encoding of int[] type</div><div class="line">  x92                # length = 2</div><div class="line">  x90                # integer 0</div><div class="line">  x91                # integer 1</div></pre></td></tr></table></figure></p>
<p>&#x53EF;&#x53D8;&#x957F;&#x5EA6;&#xFF0C;&#x65E0;&#x7C7B;&#x578B;&#xFF1A; list = {0, 1}<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">x57                  # variable-length, untyped</div><div class="line">  x90                # integer 0</div><div class="line">  x91                # integer 1</div><div class="line">  Z</div></pre></td></tr></table></figure></p>
<p>&#x56FA;&#x5B9A;&#x957F;&#x5EA6;&#xFF0C;&#x9650;&#x5236;&#x7C7B;&#x578B;&#xFF1A;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">x72                # typed list length=2</div><div class="line">  x04 [int         # type for int[] (save as type #0)</div><div class="line">  x90              # integer 0</div><div class="line">  x91              # integer 1</div><div class="line"></div><div class="line">x73                # typed list length = 3</div><div class="line">  x90              # type reference to int[] (integer #0)</div><div class="line">  x92              # integer 2</div><div class="line">  x93              # integer 3</div><div class="line">  x94              # integer 4</div></pre></td></tr></table></figure></p>
<h2 id="long"><a href="#long" class="headerlink" title="long"></a>long</h2><p>Long &#x8BED;&#x6CD5;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">long ::= L b7 b6 b5 b4 b3 b2 b1 b0</div><div class="line">     ::= [xd8-xef]</div><div class="line">     ::= [xf0-xff] b0</div><div class="line">     ::= [x38-x3f] b1 b0</div><div class="line">     ::= x4c b3 b2 b1 b0</div></pre></td></tr></table></figure></p>
<p>A 64-bit signed integer. An long is represented by the octet x4c (&#x2018;L&#x2019; ) followed by the 8-bytes of the integer in big-endian order.</p>
<p>64&#x4F4D;&#x6709;&#x7B26;&#x53F7;&#x7684;&#x6574;&#x6570;&#x3002;&#x4E00;&#x4E2A;long&#x7C7B;&#x578B;&#x6570;&#x503C;&#x4F7F;&#x7528;&#x5B57;&#x8282;<code>0x4c(&apos;L&apos;)</code>&#x5F00;&#x5934;&#xFF0C;&#x540E;&#x9762;&#x8DDF;&#x7740;8&#x4E2A;&#x5B57;&#x8282;&#x7684;&#x5927;&#x7AEF;&#x6574;&#x6570;&#x8868;&#x793A;&#x3002;</p>
<h3 id="&#x538B;&#x7F29;&#xFF1A;&#x5355;&#x5B57;&#x8282;long"><a href="#&#x538B;&#x7F29;&#xFF1A;&#x5355;&#x5B57;&#x8282;long" class="headerlink" title="&#x538B;&#x7F29;&#xFF1A;&#x5355;&#x5B57;&#x8282;long"></a>&#x538B;&#x7F29;&#xFF1A;&#x5355;&#x5B57;&#x8282;long</h3><p>Longs between -8 and 15 are represented by a single octet in the range xd8 to xef.</p>
<p>&#x4ECB;&#x4E8E;<code>-8</code>&#x5230;<code>15</code>&#x4E4B;&#x95F4;&#x7684;long&#x7C7B;&#x578B;&#xFF0C;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x53D6;&#x503C;&#x8303;&#x56F4;&#x5728;<code>[0xd8, 0xef]</code>&#x7684;&#x516B;&#x8FDB;&#x5236;&#x8868;&#x793A;&#x3002;&#x8F6C;&#x6362;&#x516C;&#x5F0F;&#xFF1A;</p>
<p>value = (code - 0xe0)</p>
<h3 id="&#x538B;&#x7F29;&#xFF1A;&#x53CC;&#x5B57;&#x8282;long"><a href="#&#x538B;&#x7F29;&#xFF1A;&#x53CC;&#x5B57;&#x8282;long" class="headerlink" title="&#x538B;&#x7F29;&#xFF1A;&#x53CC;&#x5B57;&#x8282;long"></a>&#x538B;&#x7F29;&#xFF1A;&#x53CC;&#x5B57;&#x8282;long</h3><p>Longs between -2048 and 2047 are encoded in two octets with the leading byte in the range xf0 to xff.</p>
<p>&#x4ECB;&#x4E8E;<code>-2048</code>&#x5230;<code>2047</code>&#x4E4B;&#x95F4;&#x7684;long&#x7C7B;&#x578B;&#xFF0C;&#x4F7F;&#x7528;&#x4E24;&#x4E2A;&#x516B;&#x8FDB;&#x5236;&#x6570;&#x503C;&#x8868;&#x793A;&#xFF0C;&#x5176;&#x4E2D;&#x9996;&#x5B57;&#x8282;&#x53D6;&#x503C;&#x8303;&#x56F4;&#x5728;<code>[0xf0, 0xff]</code>&#x3002;&#x8F6C;&#x6362;&#x516C;&#x5F0F;&#xFF1A;</p>
<p>value = ((code - 0xf8) &lt;&lt; 8) + b0</p>
<h3 id="&#x538B;&#x7F29;&#xFF1A;&#x4E09;&#x5B57;&#x8282;long"><a href="#&#x538B;&#x7F29;&#xFF1A;&#x4E09;&#x5B57;&#x8282;long" class="headerlink" title="&#x538B;&#x7F29;&#xFF1A;&#x4E09;&#x5B57;&#x8282;long"></a>&#x538B;&#x7F29;&#xFF1A;&#x4E09;&#x5B57;&#x8282;long</h3><p>Longs between -262144 and 262143 are encoded in three octets with the leading byte in the range x38 to x3f.</p>
<p>&#x4ECB;&#x4E8E;<code>-262144</code>&#x5230;<code>262143</code>&#x4E4B;&#x95F4;&#x7684;long&#x7C7B;&#x578B;&#xFF0C;&#x4F7F;&#x7528;&#x4E09;&#x4E2A;&#x516B;&#x8FDB;&#x5236;&#x6570;&#x503C;&#x8868;&#x793A;&#xFF0C;&#x5176;&#x4E2D;&#x9996;&#x5B57;&#x8282;&#x53D6;&#x503C;&#x8303;&#x56F4;&#x5728;<code>[0x38, 0x3f]</code>&#x3002;&#x8F6C;&#x6362;&#x516C;&#x5F0F;&#xFF1A;</p>
<p>value = ((code - 0x3c) &lt;&lt; 16) + (b1 &lt;&lt; 8) + b0</p>
<h3 id="&#x538B;&#x7F29;&#xFF1A;&#x56DB;&#x5B57;&#x8282;long"><a href="#&#x538B;&#x7F29;&#xFF1A;&#x56DB;&#x5B57;&#x8282;long" class="headerlink" title="&#x538B;&#x7F29;&#xFF1A;&#x56DB;&#x5B57;&#x8282;long"></a>&#x538B;&#x7F29;&#xFF1A;&#x56DB;&#x5B57;&#x8282;long</h3><p>Longs between which fit into 32-bits are encoded in five octets with the leading byte x4c.</p>
<p>&#x4E0D;&#x8D85;&#x8FC7;32&#x4F4D;&#x7684;long&#x7C7B;&#x578B;&#x6570;&#x503C;&#xFF0C;&#x91C7;&#x7528;5&#x4E2A;&#x5B57;&#x8282;&#x7F16;&#x7801;&#xFF0C;&#x5176;&#x4E2D;&#x9996;&#x5B57;&#x8282;&#x4E3A;<code>0x4c</code>&#x3002;&#x8F6C;&#x6362;&#x516C;&#x5F0F;&#xFF1A;</p>
<p>value = (b3 &lt;&lt; 24) + (b2 &lt;&lt; 16) + (b1 &lt;&lt; 8) + b0</p>
<h3 id="Long-&#x793A;&#x4F8B;"><a href="#Long-&#x793A;&#x4F8B;" class="headerlink" title="Long &#x793A;&#x4F8B;"></a>Long &#x793A;&#x4F8B;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">xe0                  # 0</div><div class="line">xd8                  # -8</div><div class="line">xef                  # 15</div><div class="line"></div><div class="line">xf8 x00              # 0</div><div class="line">xf0 x00              # -2048</div><div class="line">xf7 x00              # -256</div><div class="line">xff xff              # 2047</div><div class="line"></div><div class="line">x3c x00 x00          # 0</div><div class="line">x38 x00 x00          # -262144</div><div class="line">x3f xff xff          # 262143</div><div class="line"></div><div class="line">x4c x00 x00 x00 x00  # 0</div><div class="line">x4c x00 x00 x01 x2c  # 300</div><div class="line"></div><div class="line">L x00 x00 x00 x00 x00 x00 x01 x2c  # 300</div></pre></td></tr></table></figure>
<h2 id="map"><a href="#map" class="headerlink" title="map"></a>map</h2><p>Map &#x8BED;&#x6CD5;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">map        ::= M type (value value)* Z</div></pre></td></tr></table></figure></p>
<p>Represents serialized maps and can represent objects. The type element describes the type of the map.</p>
<p>&#x4EE3;&#x8868;&#x4E00;&#x4E2A;&#x5E8F;&#x5217;&#x5316;&#x7684;map&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x3002;type&#x5143;&#x7D20;&#x63CF;&#x8FF0;&#x4E86;map&#x7684;&#x7C7B;&#x578B;&#x3002;</p>
<p>The type may be empty, i.e. a zero length. The parser is responsible for choosing a type if one is not specified. For objects, unrecognized keys will be ignored.</p>
<p><code>type</code>&#x5143;&#x7D20;&#x53EF;&#x80FD;&#x4E3A;&#x7A7A;&#xFF0C;&#x5373;&#x96F6;&#x957F;&#x5EA6;&#x3002;&#x5F53;type&#x672A;&#x6307;&#x5B9A;&#x65F6;&#xFF0C;&#x7531;&#x89E3;&#x6790;&#x5668;&#x8D1F;&#x8D23;&#x9009;&#x62E9;&#x4E00;&#x4E2A;&#x7C7B;&#x578B;&#x3002;&#x5BF9;&#x4E8E;<code>object</code>&#xFF0C;&#x4E0D;&#x80FD;&#x8BC6;&#x522B;&#x7684;key&#x5C06;&#x4F1A;&#x88AB;&#x5FFD;&#x7565;&#x3002;</p>
<p>Each map is added to the reference list. Any time the parser expects a map, it must also be able to support a null or a ref.</p>
<p>&#x6BCF;&#x4E00;&#x4E2A;&#x6620;&#x5C04;&#x90FD;&#x5C06;&#x88AB;&#x6DFB;&#x52A0;&#x5230;&#x53C2;&#x8003;&#x96C6;&#x5408;&#x4E2D;&#x3002;&#x4EFB;&#x4F55;&#x65F6;&#x5019;&#xFF0C;&#x89E3;&#x6790;&#x5668;&#x90FD;&#x671F;&#x671B;&#x6709;&#x4E00;&#x4E2A;&#x6620;&#x5C04;&#xFF0C;&#x5B83;&#x5FC5;&#x987B;&#x652F;&#x6301;<code>null</code>&#x6216;&#x8005;&#x4E00;&#x4E2A;&#x5F15;&#x7528;&#x3002;</p>
<p>The type is chosen by the service.</p>
<p>&#x7C7B;&#x578B;&#x7531;service&#x9009;&#x62E9;&#x3002;</p>
<h3 id="Map-&#x793A;&#x4F8B;"><a href="#Map-&#x793A;&#x4F8B;" class="headerlink" title="Map &#x793A;&#x4F8B;"></a>Map &#x793A;&#x4F8B;</h3><p>&#x7A00;&#x758F;&#x6570;&#x7EC4;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">map = <span class="keyword">new</span> HashMap();</div><div class="line">map.put(<span class="keyword">new</span> Integer(<span class="number">1</span>), <span class="string">&quot;fee&quot;</span>);</div><div class="line">map.put(<span class="keyword">new</span> Integer(<span class="number">16</span>), <span class="string">&quot;fie&quot;</span>);</div><div class="line">map.put(<span class="keyword">new</span> Integer(<span class="number">256</span>), <span class="string">&quot;foe&quot;</span>);</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">H           # untyped map (HashMap for Java)</div><div class="line">  x91       # 1</div><div class="line">  x03 fee   # &quot;fee&quot;</div><div class="line"></div><div class="line">  xa0       # 16</div><div class="line">  x03 fie   # &quot;fie&quot;</div><div class="line"></div><div class="line">  xc9 x00   # 256</div><div class="line">  x03 foe   # &quot;foe&quot;</div><div class="line"></div><div class="line">  Z</div></pre></td></tr></table></figure>
<p>Java&#x5BF9;&#x8C61;&#x7684;map&#x8868;&#x793A;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Car</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>{</div><div class="line">  String color = <span class="string">&quot;aquamarine&quot;</span>;</div><div class="line">  String model = <span class="string">&quot;Beetle&quot;</span>;</div><div class="line">  <span class="keyword">int</span> mileage = <span class="number">65536</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">M</div><div class="line">  x13 com.caucho.test.Car  # type</div><div class="line"></div><div class="line">  x05 color                # color field</div><div class="line">  x0a aquamarine</div><div class="line"></div><div class="line">  x05 model                # model field</div><div class="line">  x06 Beetle</div><div class="line"></div><div class="line">  x07 mileage              # mileage field</div><div class="line">  I x00 x01 x00 x00</div><div class="line">  Z</div></pre></td></tr></table></figure>
<h2 id="null"><a href="#null" class="headerlink" title="null"></a>null</h2><p>Null &#x8BED;&#x6CD5;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">null ::= N</div></pre></td></tr></table></figure></p>
<p>Null &#x8868;&#x793A;&#x7A7A;&#x6307;&#x9488;&#x3002;&#x5B57;&#x8282; <code>&apos;N&apos;</code> &#x8868;&#x793A;<code>null</code>&#x503C;&#x3002;</p>
<h2 id="object"><a href="#object" class="headerlink" title="object"></a>object</h2><p>Object &#x8BED;&#x6CD5;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">class-def  ::= &apos;C&apos; string int string*</div><div class="line"></div><div class="line">object     ::= &apos;O&apos; int value*</div><div class="line">           ::= [x60-x6f] value*</div></pre></td></tr></table></figure></p>
<h3 id="&#x538B;&#x7F29;-class-definition"><a href="#&#x538B;&#x7F29;-class-definition" class="headerlink" title="&#x538B;&#x7F29;: class definition"></a>&#x538B;&#x7F29;: class definition</h3><p>Hessian 2.0 has a compact object form where the field names are only serialized once. </p>
<p>Hessian 2.0&#x5177;&#x6709;&#x7D27;&#x51D1;&#x7684;&#x5BF9;&#x8C61;&#x5F62;&#x5F0F;&#xFF0C;&#x5176;&#x4E2D;&#x5B57;&#x6BB5;&#x540D;&#x79F0;&#x4EC5;&#x88AB;&#x5E8F;&#x5217;&#x5316;&#x4E00;&#x6B21;&#x3002;</p>
<p>Following objects only need to serialize their values.</p>
<p>&#x4E4B;&#x540E;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x5E8F;&#x5217;&#x5316;&#x5B83;&#x4EEC;&#x7684;&#x503C;&#x3002;</p>
<p>The object definition includes a mandatory type string, the number of fields, and the field names. The object definition is stored in the object definition map and will be referenced by object instances with an integer reference.</p>
<h3 id="&#x538B;&#x7F29;-object-instantiation"><a href="#&#x538B;&#x7F29;-object-instantiation" class="headerlink" title="&#x538B;&#x7F29;: object instantiation"></a>&#x538B;&#x7F29;: object instantiation</h3><p>Hessian 2.0 has a compact object form where the field names are only serialized once. Following objects only need to serialize their values.</p>
<p>Hessian 2.0&#x5177;&#x6709;&#x7D27;&#x51D1;&#x7684;&#x5BF9;&#x8C61;&#x5F62;&#x5F0F;&#xFF0C;&#x5176;&#x4E2D;&#x5B57;&#x6BB5;&#x540D;&#x79F0;&#x4EC5;&#x88AB;&#x5E8F;&#x5217;&#x5316;&#x4E00;&#x6B21;&#x3002;</p>
<p>The object instantiation creates a new object based on a previous definition. The integer value refers to the object definition.</p>
<p>&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x57FA;&#x4E8E;&#x524D;&#x9762;&#x7684;&#x5B9A;&#x4E49;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x5BF9;&#x8C61;&#x3002;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#x6307;&#x5411;&#x5BF9;&#x8C61;&#x7684;&#x5B9A;&#x4E49;&#x3002;</p>
<h3 id="Object-&#x793A;&#x4F8B;"><a href="#Object-&#x793A;&#x4F8B;" class="headerlink" title="Object &#x793A;&#x4F8B;"></a>Object &#x793A;&#x4F8B;</h3><p>Object &#x5E8F;&#x5217;&#x5316;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> </span>{</div><div class="line">  String color;</div><div class="line">  String model;</div><div class="line">}</div><div class="line"></div><div class="line">out.writeObject(<span class="keyword">new</span> Car(<span class="string">&quot;red&quot;</span>, <span class="string">&quot;corvette&quot;</span>));</div><div class="line">out.writeObject(<span class="keyword">new</span> Car(<span class="string">&quot;green&quot;</span>, <span class="string">&quot;civic&quot;</span>));</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">C                        # object definition (#0)</div><div class="line">  x0b example.Car        # type is example.Car</div><div class="line">  x92                    # two fields</div><div class="line">  x05 color              # color field name</div><div class="line">  x05 model              # model field name</div><div class="line"></div><div class="line">O                        # object def (long form)</div><div class="line">  x90                    # object definition #0</div><div class="line">  x03 red                # color field value</div><div class="line">  x08 corvette           # model field value</div><div class="line"></div><div class="line">x60                      # object def #0 (short form)</div><div class="line">  x05 green              # color field value</div><div class="line">  x05 civic              # model field value</div></pre></td></tr></table></figure>
<p>&#x679A;&#x4E3E;&#x7C7B;&#x578B;&#xFF1A;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"> enum Color {</div><div class="line">  RED,</div><div class="line">  GREEN,</div><div class="line">  BLUE,</div><div class="line">}</div><div class="line"></div><div class="line">out.writeObject(Color.RED);</div><div class="line">out.writeObject(Color.GREEN);</div><div class="line">out.writeObject(Color.BLUE);</div><div class="line">out.writeObject(Color.GREEN);</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">C                         # class definition #0</div><div class="line">  x0b example.Color       # type is example.Color</div><div class="line">  x91                     # one field</div><div class="line">  x04 name                # enumeration field is &quot;name&quot;</div><div class="line"></div><div class="line">x60                       # object #0 (class def #0)</div><div class="line">  x03 RED                 # RED value</div><div class="line"></div><div class="line">x60                       # object #1 (class def #0)</div><div class="line">  x90                     # object definition ref #0</div><div class="line">  x05 GREEN               # GREEN value</div><div class="line"></div><div class="line">x60                       # object #2 (class def #0)</div><div class="line">  x04 BLUE                # BLUE value</div><div class="line"></div><div class="line">x51 x91                   # object ref #1, i.e. Color.GREEN</div></pre></td></tr></table></figure>
<h2 id="ref"><a href="#ref" class="headerlink" title="ref"></a>ref</h2><p>Ref &#x8BED;&#x6CD5;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ref ::= x51 int</div></pre></td></tr></table></figure></p>
<p>An integer referring to a previous list, map, or object instance. As each list, map or object is read from the input stream, it is assigned the integer position in the stream, i.e. the first list or map is &#x2018;0&#x2019;, the next is &#x2018;1&#x2019;, etc. A later ref can then use the previous object. Writers MAY generate refs. Parsers MUST be able to recognize them.</p>
<p>&#x4E00;&#x4E2A;&#x6574;&#x6570;&#x6307;&#x5411;&#x4E00;&#x4E2A;&#x524D;&#x9762;&#x7684;list&#x3001;map&#x6216;&#x8005;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x3002;&#x5BF9;&#x4E8E;&#x6BCF;&#x4E00;&#x4E2A;&#x4ECE;&#x8F93;&#x5165;&#x6D41;&#x4E2D;&#x8BFB;&#x5230;&#x7684;list&#x3001;map&#x6216;&#x8005;&#x5BF9;&#x8C61;&#xFF0C;&#x5B83;&#x90FD;&#x88AB;&#x6307;&#x5B9A;&#x4E86;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x5373;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;list&#x6216;map&#x7684;&#x4F4D;&#x7F6E;&#x662F;<code>0</code>&#xFF0C;&#x4E0B;&#x4E00;&#x4E2A;&#x662F;<code>1</code>,&#x7B49;&#x7B49;&#x3002;&#x540E;&#x9762;&#x7684;&#x5F15;&#x7528;&#x53EF;&#x4EE5;&#x6307;&#x5411;&#x524D;&#x9762;&#x7684;&#x5BF9;&#x8C61;&#x3002;&#x5199;&#x5165;&#x5668;&#x53EF;&#x80FD;&#x4F1A;&#x751F;&#x6210;&#x5F15;&#x7528;&#xFF0C;&#x89E3;&#x6790;&#x5668;&#x4E00;&#x5B9A;&#x8981;&#x80FD;&#x591F;&#x6CE8;&#x518C;&#x5B83;&#x4EEC;&#x3002;</p>
<p>&#x8BD1;&#x8005;&#x6CE8;&#xFF1A;<code>ref</code>&#x53EF;&#x4EE5;&#x7406;&#x89E3;&#x4E3A;&#x6307;&#x9488;&#x3002;</p>
<p>ref can refer to incompletely-read items. For example, a circular linked-list will refer to the first link before the entire list has been read.</p>
<p>ref&#x53EF;&#x4EE5;&#x6307;&#x5411;&#x4E00;&#x4E2A;&#x5DF2;&#x7ECF;&#x8BFB;&#x53D6;&#x5B8C;&#x7684;&#x9879;&#x3002;&#x4F8B;&#x5982;&#xFF1A;&#x4E00;&#x4E2A;&#x5FAA;&#x73AF;&#x94FE;&#x8868;&#x5728;&#x6574;&#x4E2A;&#x8BFB;&#x53D6;&#x5B8C;&#x4E4B;&#x524D;&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x6307;&#x5411;&#x7B2C;&#x4E00;&#x4E2A;&#x94FE;&#x63A5;&#x3002;</p>
<p>A possible implementation would add each map, list, and object to an array as it is read. The ref will return the corresponding value from the array. To support circular structures, the implementation would store the map, list or object immediately, before filling in the contents.</p>
<p>Each map or list is stored into an array as it is parsed. ref selects one of the stored objects. The first object is numbered &#x2018;0&#x2019;.</p>
<h3 id="Ref-&#x793A;&#x4F8B;"><a href="#Ref-&#x793A;&#x4F8B;" class="headerlink" title="Ref &#x793A;&#x4F8B;"></a>Ref &#x793A;&#x4F8B;</h3><p>Circular list<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">list = new LinkedList();</div><div class="line">list.data = 1;</div><div class="line">list.tail = list;</div><div class="line"></div><div class="line">---</div><div class="line">C</div><div class="line">  x0a LinkedList</div><div class="line">  x92</div><div class="line">  x04 head</div><div class="line">  x04 tail</div><div class="line"></div><div class="line">o x90      # object stores ref #0</div><div class="line">  x91      # data = 1</div><div class="line">  x51 x90  # next field refers to itself, i.e. ref #0</div></pre></td></tr></table></figure></p>
<p>ref only refers to list, map and objects elements. Strings and binary data, in particular, will only share references if they&#x2019;re wrapped in a list or map.</p>
<h3 id="string"><a href="#string" class="headerlink" title="string"></a>string</h3><p>String &#x8BED;&#x6CD5;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">string ::= x52 b1 b0 &lt;utf8-data&gt; string</div><div class="line">       ::= S b1 b0 &lt;utf8-data&gt;</div><div class="line">       ::= [x00-x1f] &lt;utf8-data&gt;</div><div class="line">       ::= [x30-x33] b0 &lt;utf8-data&gt;</div></pre></td></tr></table></figure></p>
<p>A 16-bit unicode character string encoded in UTF-8. Strings are encoded in chunks. x53 (&#x2018;S&#x2019;) represents the final chunk and x52 (&#x2018;R&#x2019;) represents any non-final chunk. Each chunk has a 16-bit unsigned integer length value.</p>
<p>The length is the number of 16-bit characters, which may be different than the number of bytes.</p>
<p>String chunks may not split surrogate pairs.</p>
<h3 id="&#x538B;&#x7F29;-short-strings"><a href="#&#x538B;&#x7F29;-short-strings" class="headerlink" title="&#x538B;&#x7F29;: short strings"></a>&#x538B;&#x7F29;: short strings</h3><p>Strings with length less than 32 may be encoded with a single octet length [x00-x1f].</p>
<p>value = code</p>
<h2 id="String-&#x793A;&#x4F8B;"><a href="#String-&#x793A;&#x4F8B;" class="headerlink" title="String &#x793A;&#x4F8B;"></a>String &#x793A;&#x4F8B;</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">x00                 # &quot;&quot;, empty string</div><div class="line">x05 hello           # &quot;hello&quot;</div><div class="line">x01 xc3 x83         # &quot;\u00c3&quot;</div><div class="line"></div><div class="line">S x00 x05 hello     # &quot;hello&quot; in long form</div><div class="line"></div><div class="line">x52 x00 x07 hello,  # &quot;hello, world&quot; split into two chunks</div><div class="line">  x05 world</div></pre></td></tr></table></figure>
<h2 id="type"><a href="#type" class="headerlink" title="type"></a>type</h2><p>Type &#x8BED;&#x6CD5;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">type ::= string</div><div class="line">     ::= int</div></pre></td></tr></table></figure></p>
<p>A <code>map</code> or <code>list</code> includes a type attribute indicating the type name of the map or list for object-oriented languages.</p>
<p>Each type is added to the <code>type map</code> for future reference.</p>
<h2 id="&#x538B;&#x7F29;-type-&#x5F15;&#x7528;"><a href="#&#x538B;&#x7F29;-type-&#x5F15;&#x7528;" class="headerlink" title="&#x538B;&#x7F29;: type &#x5F15;&#x7528;"></a>&#x538B;&#x7F29;: type &#x5F15;&#x7528;</h2><p>Repeated type strings MAY use the <code>type map</code> to refer to a previously used type. The type reference is zero-based over all the types encountered during parsing.</p>
<h1 id="&#x5F15;&#x7528;&#x6620;&#x5C04;"><a href="#&#x5F15;&#x7528;&#x6620;&#x5C04;" class="headerlink" title="&#x5F15;&#x7528;&#x6620;&#x5C04;"></a>&#x5F15;&#x7528;&#x6620;&#x5C04;</h1><p>Hessian 2.0 &#x6709;&#x4E09;&#x79CD;&#x5185;&#x7F6E;&#x5F15;&#x7528;&#x6620;&#x5C04;:</p>
<ul class="ui list">
<li>An map/object/list reference map.</li>
<li>An class definition map.</li>
<li>A type (class name) map.</li>
</ul>
<p>The value reference map lets Hessian support arbitrary graphs, and recursive and circular data structures.</p>
<p>The class and type maps improve Hessian efficiency by avoiding repetition of common string data.</p>
<h2 id="&#x503C;&#x5F15;&#x7528;"><a href="#&#x503C;&#x5F15;&#x7528;" class="headerlink" title="&#x503C;&#x5F15;&#x7528;"></a>&#x503C;&#x5F15;&#x7528;</h2><p>Hessian supports arbitrary graphs by adding <code>list</code>, <code>object</code>, and <code>map</code> as it encounters them in the bytecode stream.</p>
<p>Parsers MUST store each list, object and map in the reference map as they are encountered.</p>
<p>The stored objects can be used with a ref bytecode.</p>
<h2 id="class-&#x5F15;&#x7528;"><a href="#class-&#x5F15;&#x7528;" class="headerlink" title="class &#x5F15;&#x7528;"></a>class &#x5F15;&#x7528;</h2><p>Each <code>object definition</code> is automatically added to the class-map. Parsers MUST add a class definition to the class map as each is encountered. Following object instances will refer to the defined class.</p>
<h2 id="type-&#x5F15;&#x7528;"><a href="#type-&#x5F15;&#x7528;" class="headerlink" title="type &#x5F15;&#x7528;"></a>type &#x5F15;&#x7528;</h2><p>The <code>type</code> strings for <code>map</code> and <code>list</code> values are stored in a type map for reference.</p>
<p>Parsers MUST add a type string to the type map as each is encountered.</p>
<h1 id="&#x5B57;&#x8282;&#x6620;&#x5C04;"><a href="#&#x5B57;&#x8282;&#x6620;&#x5C04;" class="headerlink" title="&#x5B57;&#x8282;&#x6620;&#x5C04;"></a>&#x5B57;&#x8282;&#x6620;&#x5C04;</h1><p>Hessian is organized as a bytecode protocol. A Hessian reader is essentially a switch statement on the initial octet.</p>
<p>&#x5B57;&#x8282;&#x7F16;&#x7801;&#xFF1A;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line">x00 - x1f    # utf-8 string length 0-32</div><div class="line">x20 - x2f    # binary data length 0-16</div><div class="line">x30 - x33    # utf-8 string length 0-1023</div><div class="line">x34 - x37    # binary data length 0-1023</div><div class="line">x38 - x3f    # three-octet compact long (-x40000 to x3ffff)</div><div class="line">x40          # reserved (expansion/escape)</div><div class="line">x41          # 8-bit binary data non-final chunk (&apos;A&apos;)</div><div class="line">x42          # 8-bit binary data final chunk (&apos;B&apos;)</div><div class="line">x43          # object type definition (&apos;C&apos;)</div><div class="line">x44          # 64-bit IEEE encoded double (&apos;D&apos;)</div><div class="line">x45          # reserved</div><div class="line">x46          # boolean false (&apos;F&apos;)</div><div class="line">x47          # reserved</div><div class="line">x48          # untyped map (&apos;H&apos;)</div><div class="line">x49          # 32-bit signed integer (&apos;I&apos;)</div><div class="line">x4a          # 64-bit UTC millisecond date</div><div class="line">x4b          # 32-bit UTC minute date</div><div class="line">x4c          # 64-bit signed long integer (&apos;L&apos;)</div><div class="line">x4d          # map with type (&apos;M&apos;)</div><div class="line">x4e          # null (&apos;N&apos;)</div><div class="line">x4f          # object instance (&apos;O&apos;)</div><div class="line">x50          # reserved</div><div class="line">x51          # reference to map/list/object - integer (&apos;Q&apos;)</div><div class="line">x52          # utf-8 string non-final chunk (&apos;R&apos;)</div><div class="line">x53          # utf-8 string final chunk (&apos;S&apos;)</div><div class="line">x54          # boolean true (&apos;T&apos;)</div><div class="line">x55          # variable-length list/vector (&apos;U&apos;)</div><div class="line">x56          # fixed-length list/vector (&apos;V&apos;)</div><div class="line">x57          # variable-length untyped list/vector (&apos;W&apos;)</div><div class="line">x58          # fixed-length untyped list/vector (&apos;X&apos;)</div><div class="line">x59          # long encoded as 32-bit int (&apos;Y&apos;)</div><div class="line">x5a          # list/map terminator (&apos;Z&apos;)</div><div class="line">x5b          # double 0.0</div><div class="line">x5c          # double 1.0</div><div class="line">x5d          # double represented as byte (-128.0 to 127.0)</div><div class="line">x5e          # double represented as short (-32768.0 to 327676.0)</div><div class="line">x5f          # double represented as float</div><div class="line">x60 - x6f    # object with direct type</div><div class="line">x70 - x77    # fixed list with direct length</div><div class="line">x78 - x7f    # fixed untyped list with direct length</div><div class="line">x80 - xbf    # one-octet compact int (-x10 to x3f, x90 is 0)</div><div class="line">xc0 - xcf    # two-octet compact int (-x800 to x7ff)</div><div class="line">xd0 - xd7    # three-octet compact int (-x40000 to x3ffff)</div><div class="line">xd8 - xef    # one-octet compact long (-x8 to xf, xe0 is 0)</div><div class="line">xf0 - xff    # two-octet compact long (-x800 to x7ff, xf8 is 0)</div></pre></td></tr></table></figure></p>
<h1 id="&#x4F5C;&#x8005;&#x8054;&#x7CFB;&#x65B9;&#x5F0F;"><a href="#&#x4F5C;&#x8005;&#x8054;&#x7CFB;&#x65B9;&#x5F0F;" class="headerlink" title="&#x4F5C;&#x8005;&#x8054;&#x7CFB;&#x65B9;&#x5F0F;"></a>&#x4F5C;&#x8005;&#x8054;&#x7CFB;&#x65B9;&#x5F0F;</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Scott Ferguson</div><div class="line">Caucho Technology Inc.</div><div class="line">P.O. Box 9001</div><div class="line">La Jolla, CA 92038</div><div class="line">USA</div><div class="line">Email: 	ferg@caucho.com</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Emil Ong</div><div class="line">Caucho Technology Inc.</div><div class="line">P.O. Box 9001</div><div class="line">La Jolla, CA 92038</div><div class="line">USA</div><div class="line">Email: 	emil@caucho.com</div></pre></td></tr></table></figure>
<h1 id="Full-Copyright-Statement"><a href="#Full-Copyright-Statement" class="headerlink" title="Full Copyright Statement"></a>Full Copyright Statement</h1><p>Copyright &#xA9; The IETF Trust (2007).</p>
<p>This document is subject to the rights, licenses and restrictions contained in BCP 78, and except as set forth therein, the authors retain all their rights.</p>
<p>This document and the information contained herein are provided on an &#x201C;AS IS&#x201D; basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.</p>
<h1 id="Intellectual-Property"><a href="#Intellectual-Property" class="headerlink" title="Intellectual Property"></a>Intellectual Property</h1><p>The IETF takes no position regarding the validity or scope of any Intellectual Property Rights or other rights that might be claimed to pertain to the implementation or use of the technology described in this document or the extent to which any license under such rights might or might not be available; nor does it represent that it has made any independent effort to identify any such rights. Information on the procedures with respect to rights in RFC documents can be found in BCP 78 and BCP 79.</p>
<p>Copies of IPR disclosures made to the IETF Secretariat and any assurances of licenses to be made available, or the result of an attempt made to obtain a general license or permission for the use of such proprietary rights by implementers or users of this specification can be obtained from the IETF on-line IPR repository at <a href="http://www.ietf.org/ipr" target="_blank" rel="external">http://www.ietf.org/ipr</a>.</p>
<p>The IETF invites any interested party to bring to its attention any copyrights, patents or patent applications, or other proprietary rights that may cover technology that may be required to implement this standard. Please address the information to the IETF at ietf-ipr@ietf.org.</p>

                        
                    </div>

                    
                    
                    

                    <div class="description post-description">
    <span class="post-description-item">
        <time datetime="2017-06-18T03:05:53.000Z" itemprop="datePublished">2017-06-18</time>

    </span>
    <span class="post-description-item">
        

    <span>
        <i class="tags icon"></i>
    </span>

    
    <span class="ui tiny label">
        <a href="/tags/hessian/">hessian</a>
    </span>

    
    <span class="ui tiny label">
        <a href="/tags/序列化/">序列化</a>
    </span>

    

    </span>
</div>

                </div>
                
                <div id="pagination" class="nav-web ui text container pagination">

    <div class="ui stackable two column divided grid container">
        <div class="row">
            <div class="column nav-left">
                

                <a href="/2017/06/26/java-AES使用/" class="ui tiny button">

                    <i class="angle left icon"></i>
                    
                    java AES使用
                    

                </a>

                
            </div>
            <div class="column nav-right">
                

                <a href="/2017/06/15/Spring-MVC基本配置/" class="ui tiny button">
                    
                    Spring MVC基本配置
                    
                    <i class="angle right icon"></i></a>
                
            </div>
        </div>
    </div>

</div>
                
            </div>

            
            <div class="three wide computer three wide tablet column">

                <div class="ui sticky article-toc" id="article-toc">
                    <!-- toc -->
                    <ol class="ui ordered list"><li><a href="#介绍"><span>介绍</span></a></li><li><a href="#设计目标"><span>设计目标</span></a></li><li><a href="#Hessian-语法"><span>Hessian 语法</span></a><ol><li><a href="#序列化语法"><span>序列化语法</span></a></li></ol></li><li><a href="#序列化"><span>序列化</span></a><ol><li><a href="#二进制数据"><span>二进制数据</span></a><ol><li><a href="#压缩短二进制"><span>压缩短二进制</span></a></li><li><a href="#二进制示例"><span>二进制示例</span></a></li></ol></li><li><a href="#boolean"><span>boolean</span></a><ol><li><a href="#Boolean-示例"><span>Boolean 示例</span></a></li></ol></li><li><a href="#date"><span>date</span></a><ol><li><a href="#压缩：使用分钟表示日期"><span>压缩：使用分钟表示日期</span></a></li><li><a href="#日期-示例"><span>日期 示例</span></a></li></ol></li><li><a href="#double"><span>double</span></a><ol><li><a href="#压缩：double-zero"><span>压缩：double zero</span></a></li><li><a href="#压缩：double-one"><span>压缩：double one</span></a></li><li><a href="#压缩-double-octet"><span>压缩: double octet</span></a></li><li><a href="#压缩-double-short"><span>压缩: double short</span></a></li><li><a href="#压缩-double-float"><span>压缩: double float</span></a></li><li><a href="#Double-示例"><span>Double 示例</span></a></li></ol></li><li><a href="#int"><span>int</span></a><ol><li><a href="#压缩：单字节整数"><span>压缩：单字节整数</span></a></li><li><a href="#压缩：双字节整数"><span>压缩：双字节整数</span></a></li><li><a href="#压缩：三字节整数"><span>压缩：三字节整数</span></a></li><li><a href="#Integer-示例"><span>Integer 示例</span></a></li></ol></li><li><a href="#list"><span>list</span></a><ol><li><a href="#Compact-fixed-length-list"><span>Compact: fixed length list</span></a></li><li><a href="#List-示例"><span>List 示例</span></a></li></ol></li><li><a href="#long"><span>long</span></a><ol><li><a href="#压缩：单字节long"><span>压缩：单字节long</span></a></li><li><a href="#压缩：双字节long"><span>压缩：双字节long</span></a></li><li><a href="#压缩：三字节long"><span>压缩：三字节long</span></a></li><li><a href="#压缩：四字节long"><span>压缩：四字节long</span></a></li><li><a href="#Long-示例"><span>Long 示例</span></a></li></ol></li><li><a href="#map"><span>map</span></a><ol><li><a href="#Map-示例"><span>Map 示例</span></a></li></ol></li><li><a href="#null"><span>null</span></a></li><li><a href="#object"><span>object</span></a><ol><li><a href="#压缩-class-definition"><span>压缩: class definition</span></a></li><li><a href="#压缩-object-instantiation"><span>压缩: object instantiation</span></a></li><li><a href="#Object-示例"><span>Object 示例</span></a></li></ol></li><li><a href="#ref"><span>ref</span></a><ol><li><a href="#Ref-示例"><span>Ref 示例</span></a></li><li><a href="#string"><span>string</span></a></li><li><a href="#压缩-short-strings"><span>压缩: short strings</span></a></li></ol></li><li><a href="#String-示例"><span>String 示例</span></a></li><li><a href="#type"><span>type</span></a></li><li><a href="#压缩-type-引用"><span>压缩: type 引用</span></a></li></ol></li><li><a href="#引用映射"><span>引用映射</span></a><ol><li><a href="#值引用"><span>值引用</span></a></li><li><a href="#class-引用"><span>class 引用</span></a></li><li><a href="#type-引用"><span>type 引用</span></a></li></ol></li><li><a href="#字节映射"><span>字节映射</span></a></li><li><a href="#作者联系方式"><span>作者联系方式</span></a></li><li><a href="#Full-Copyright-Statement"><span>Full Copyright Statement</span></a></li><li><a href="#Intellectual-Property"><span>Intellectual Property</span></a></li></ol>
                </div>

            </div>
            

        </div>
    </div>
</div>


            </div>
            <div class="ui vertical footer segment">
    <div class="ui center aligned container">
        <div class="ui inverted section divider"></div>
        &copy; 2017 <a href="/">YFHan</a>,
        Powered by <a href="https://github.com/henryhuang/hexo-theme-aloha" target="_blank">Aloha</a> and <a
                href="http://hexo.io/" target="_blank">Hexo</a>.
    </div>
</div>

        </div>

    
        
            <script src="//cdn.bootcss.com/jquery/3.1.0/jquery.min.js"></script>
        
            <script src="//cdn.bootcss.com/semantic-ui/2.2.4/semantic.min.js"></script>
        
            <script src="//cdn.bootcss.com/algoliasearch/3.18.1/algoliasearch.min.js"></script>
        
            <script src="//cdn.bootcss.com/algoliasearch-helper-js/2.13.0/algoliasearch.helper.min.js"></script>
        
            <script src="/js/semantic-ui-algolia.js"></script>
        
            <script src="/js/aloha-events.js"></script>
        
    

</body>
</html>
